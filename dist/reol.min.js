(function(t,n){"undefined"!=typeof module?module.exports=n():"function"==typeof define&&"object"==typeof define.amd?define(n):this[t]=n()})("Reol",function(){"use strict";function t(t){var n;this.index={},this.indexes={};for(n in t)this.index[n]={},this.indexes[n]=t[n];return this}function n(n,i){var r="";return i[n]?r=t.stringify(i[n]):n.indexOf(".")&&(r=t.stringify(t.findByPath(i,n))),this.index[n].hasOwnProperty(r)?!1:(this.index[n][r]=i,!0)}return t.prototype=[],t.stringify=function(t){var n="";return n="object"==typeof t?JSON.stringify(t):t+""},t.findByPath=function(n,i){var r;return i=i.split("."),r=i.shift(),r?t.findByPath(n[r],i.join(".")):n},t.prototype.add=function(t,i){var r,e;if(i=i||function(){},"object"!=typeof t){if(r=Error("Sorry, this class only works with objects."),!i)throw r;i(r)}this.push(t);for(e in this.indexes)n.call(this,e,t);return this},t.prototype.merge=function(t,n){var i,r;for(i=0,r=t.length;r>i;i++)this.add(t[i]);return n&&n(),this},t.prototype.find=function(t,n,i){var r,e,o;n=n||function(){};for(e in t)if(t.hasOwnProperty(e)){r=e;break}return r?(o=this.index[r]?this.findInIndex(r,t[r]):this.findInList(r,t[r],i),o=!o&&[]||void 0!==o.length&&o||[o],n(null,o),o):(n(this.toArray()),this.toArray())},t.prototype.findOne=function(t,n){return this.find(t,function(t,i){n&&n(t,i[0])},!0)[0]},t.prototype.findInIndex=function(n,i){return this.index[n][t.stringify(i)]},t.prototype.findInList=function(t,n,i){var r,e,o=[],f=this;for(r=0,e=f.length;e>r&&(!f[r].hasOwnProperty(t)||f[r][t]!==n||(o.push(f[r]),!i));r++);return o},t.prototype.toArray=function(){return this},t});